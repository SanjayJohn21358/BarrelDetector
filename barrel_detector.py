'''
ECE276A WI19 HW1
Blue Barrel Detector
'''

import os
import cv2
from skimage.measure import label, regionprops
from skimage import data, util, img_as_ubyte
from skimage.morphology import erosion, dilation, opening, closing, disk
from matplotlib import pyplot as plt
import matplotlib.patches as patches
import numpy as np
import math
import train

class BarrelDetector(object):
	def __init__(self):
		'''
			Initialize your blue barrel detector with the attributes you need
			eg. parameters of your classifier
		'''
		
	def segment_image(self, img):
		'''
			Calculate the segmented image using a classifier
			eg. Single Gaussian, Gaussian Mixture, or Logistic Regression
			call other functions in this class if needed
			
			Inputs:
				img - original image
			Outputs:
				mask_img - a binary image with 1 if the pixel in the original image is blue and 0 otherwise
		'''
		#use model to find blue parts of image
		img2 = cv2.cvtColor(img,cv2.COLOR_BGR2RGB)
		model = train.LR_Model()
		#model.load('weights.pickle')
		model.weights = np.array([[0.7246328196217886, 0.6323446790434922, 0.645286907890168], [0.6430110810398693, 0.4733223294109216, 0.7117432066081286], [0.38989614242175435, 0.48507713120860263, 0.5386118035840552], [0.7761794457437844, 0.24776395773395377, 0.26416624984437515], [0.377853352907376, 0.7344783479036225, 0.6385404277844752], [0.33955780677379493, 0.5676830597854614, 0.31485571670202395], [0.7690854125763243, 0.6419718169535216, 0.7572114362844945], [0.7152073779599595, 0.5473397988275562, 0.7800354076613181], [0.8025906878436355, 0.8472886203101883, 0.8229192480632368], [0.39126162272659737, 0.4484641923828971, 0.644427620565509], [0.4531743963632796, 0.37750127098223385, 0.694444234181581], [0.5419845480467238, 0.6475961527814031, 0.6174515775390025], [0.6735951636179331, 0.2630653105079765, 0.4094909579817122], [0.06140943489103298, 0.2750496109095568, 0.11897508370788179], [0.655394005673757, 0.6996804716765811, 0.4183600790705883], [0.188531658762994, 0.5685475229716629, 0.27262278971375264], [0.4476632786753518, 0.3112348049319205, 0.5514591192645482], [0.34031928729637395, 0.20313748847883678, 0.646257739756337], [0.2605280038259221, 0.4224589909557922, 0.2234455004435162], [0.8110698216496671, 0.6599251559006453, 0.7338923213876248], [0.6139389895660964, 0.8435909485372908, 0.5802572871584692], [0.6794484865881538, 0.8561507156492084, 0.7598910197279125], [0.5298914240776903, 0.5045443072230595, 0.6219576121591128], [0.6714300502136538, 0.12741172612402124, 0.6127671510795674], [0.8195695279345493, 0.9242156106629257, 0.6346773556204427], [0.8484327160963213, 0.3433155238415678, 0.5989821865353566], [0.270220656065972, 0.5196810276323439, 0.6419799680332711], [0.3448828814830471, 0.7597539532586116, 0.20865470655219587], [0.41528788881570744, 0.7850982803415218, 0.371716167613791], [0.7799022912567101, 0.6936254167120535, 0.9320628869773263], [0.7045803329947007, 0.738448584318525, 0.4184663705073777], [0.7294844022322777, 0.7707925113009523, 0.3626924988227393], [0.5235755031802296, 0.5877733913819279, 0.4965269515658339], [0.4621106922619986, 0.7932660152184209, 0.731970285016819], [0.5087878988062755, 0.14308793191585856, 0.23849730864005955], [0.6375597711165623, 0.4756905797678925, 0.4281063374178075], [0.5513244007839228, 0.29850686234458723, 0.6308492202395255], [0.3408041224720356, 0.6175616707938447, 0.22801068161537533], [0.5624761824355864, 0.5832131982459704, 0.4271637530811957], [0.7139707057098303, 0.7267460420304968, 0.3590645991274429], [0.2603595521566581, 0.6623675304380332, 0.5437147264889256], [0.6590344555947983, 0.5426434382074751, 0.2228923468823586], [0.57792061891063, 0.12349659594720931, 0.5495510507246605], [0.5720790452197053, 0.22341426641644613, 0.8422183046787567], [0.40604337663271173, 0.24333910057891078, 0.5064608379099446], [0.5694313885046007, 0.6743830442382615, 0.8829932172185616], [0.591986631706107, 0.5946525210431003, 0.5068003198355059], [0.23947325565700933, 0.5657850263707109, 0.20032825628732306], [0.7771191666417303, 0.4893094824102333, 0.6033589068782288], [0.08892473952165396, 0.3856360967702811, 0.29565717844004824], [0.5695660779172534, 0.41658868126542253, 0.6210986257612182], [0.4633925974138564, 0.5241515833265484, 0.5817000751936983], [0.22615108685796578, 0.023471171560094983, 0.10275652360193659], [0.6331289674944616, 0.7257866799601306, 0.7613945797447872], [0.43757789309617684, 0.793906577804279, 0.847821277911974], [0.324136849466194, 0.5792261625189138, 0.24391456322040783], [0.5341828286856622, 0.7962950128112543, 0.5210345841245763], [0.23222549941811846, 0.19676582276854584, 0.3443323035883931], [0.3861788882179055, 0.18749078950157455, 0.3942554195928388], [0.6674052359099523, 0.5614820970465071, 0.47380960020596186], [0.1527836920927075, 0.17505255246225765, 0.4706552019603651], [0.7461206039426692, 0.16095591173038512, 0.4681704691271241], [0.22890874591285088, 0.7418438519579653, 0.5225679737722186], [0.7352100438871975, 0.2282944018856634, 0.7496533255880649], [0.6967628763558912, 0.3454029409213748, 0.7719247115879824], [0.2516825475304539, 0.6950100839402877, 0.10340067716283018], [0.6954626929527122, 0.5037117025164854, 0.676128954267895], [0.2482635811266176, 0.5573716734681277, 0.5600954281004079], [0.3358545083315261, 0.4630161050547233, 0.09562433655464374], [0.7753239710590151, 0.19061816919838226, 0.48699777070180666], [0.7772149501950518, 0.6518842919734905, 0.5681618629966767], [0.34203782503313096, 0.5822175558635867, 0.47764332249023006], [0.4264624534610253, 0.21455134232385942, 0.5604036526299563], [0.45510643583687266, 0.793175767361963, 0.3018710714106123], [0.3095301629686136, 0.36902795245843, 0.5201610638336898], [0.2979622000814753, 0.39684061245699304, 0.3575342795937526], [0.773909939546071, 0.709922237912878, 0.827769019269726], [0.3281562458866285, 0.4293575684664655, 0.1044950996625374], [0.690156148105577, 0.7393180063999573, 0.80744334035186], [0.7566229615204079, 0.5480726288725266, 0.8596505446296644], [0.49105084842097885, 0.6626206680749789, 0.28898913840030765], [0.41439501293505715, 0.345313298394514, 0.611507192641051], [0.7515686868085942, 0.9595073789407199, 0.8409592629850522], [0.44756194797423604, 0.24070294401375583, 0.41758727423470887], [0.5215823767847613, 0.1981750020905575, 0.7581118733396374], [0.845202158312005, 0.5106438425821545, 0.8290085458402241], [0.23943419276142158, 0.7219799174811815, 0.40906393206296204], [0.6581732675508919, 0.9200810138947626, 0.26470621720248994], [0.31005260017976655, 0.21607153815018568, 0.34568562980541284], [0.5341819701976522, 0.4018935074085079, 0.621125357415682], [0.6072040937217563, 0.4211604507359248, 0.17660073823681163], [0.7211931635573486, 0.7063854604246749, 0.5641114212774602], [0.757501808622654, 0.7012823808496098, 0.7670907098951812], [0.25546012799053797, 0.7740891968717222, 0.41011838803939543], [0.8097482963433397, 0.7740748365178222, 0.9436705062665235], [0.3505232191402693, 0.6679916979640254, 0.16408779134768733], [0.7709164108872365, 0.4402281211303716, 0.7657882708509606], [0.4140293995843338, 0.21246318985960375, 0.1478476795110455], [0.07477367902757567, 0.07538140103097407, 0.2854736909417093], [0.3806627915109585, 0.8502630529162075, 0.7964766935658177], [0.7365303454052081, 0.7989940370318367, 0.38541122315756077], [0.7816376230469528, 0.32792130599255426, 0.7535986888067105], [0.20142959439955685, 0.13933252163652093, 0.42064675513590377], [0.5267779562980205, 0.5689999147760405, 0.3670780729033471], [0.445110674946845, 0.5497866433969357, 0.3504323864499947], [0.3485323658936743, 0.63668860675679, 0.7844366097483195], [0.2907033669599321, 0.614326003846776, 0.29205731353805775], [0.9259718794039451, 0.7697505828027545, 0.9159133653538163], [0.7615973209590094, 0.9123760884760888, 0.4031574842468161], [0.39822892618934297, 0.22177538250999318, 0.4965799787146755], [0.7011989213949623, 0.3781630687598387, 0.9517804722650662], [0.8453659053392091, 1.0199424355729836, 0.6306903543072626], [0.8561819985779501, 0.9732607160534724, 0.6768277489017952], [0.8971043948564593, 0.7412833585346245, 1.0075908684079915], [0.6963970536597008, 0.7896045837472822, 0.3776451556255699], [0.1641971968257246, 0.6219121565406049, 0.272806387837055], [0.6846383824382835, 0.2582718687042901, 0.7252782384771362], [0.5068575630543622, 0.44442479868147444, 0.22058460528092527], [0.1216988576934983, 0.4277771012237428, 0.43952672708555723], [0.6029908655255224, 0.8202714446145415, 0.8667379930806893], [0.7964628107927253, 0.22604515810440465, 0.8141915198843195], [0.2433088515482753, 0.495558624517054, 0.2918992082013595], [0.703563335935125, 0.36007008944280644, 0.6360898694362073], [0.23030787230662417, 0.31861562709937674, 0.5425319050753293], [0.6325629931881147, 0.3411254960972033, 0.43979645423708597], [0.6607894578853646, 0.3440725327647709, 0.7745393499409395], [0.40871391360608306, 0.9135792344029369, 0.6844927724343007], [0.8047082163558401, 0.7867201664018508, 0.9281936175256125], [0.771621056701876, 0.8847242588915372, 0.7251769367401574], [0.7748994596077667, 0.4174597076372852, 0.7710239953461819], [0.5923344175425401, 0.23584884646425136, 0.7844666880471651], [0.7907248680686454, 0.3810786303019399, 0.7573743859911292], [0.24979176444396148, 0.7770264231385442, 0.4509341562496588], [0.5269344697572312, 0.22794665878214537, 0.15338117094350645], [0.7251774482787409, 0.23032058738285532, 0.8495540815566], [0.10437399001618596, 0.17143628741982947, 0.32379779652148155], [0.6847271824502853, 0.8183372349351964, 0.48268405571246376], [0.659226421965393, 0.2163494754381935, 0.6701881588950432], [0.376282851593742, 0.8783306800972167, 0.32816588256663054], [0.45081556579317755, 0.5301683971933485, 0.6166731873154079], [0.7839395249787464, 0.9082808044860482, 0.47098983247885], [0.5626676113670117, 0.27617452863157377, 0.34248585052236696], [0.3281466876663573, 0.48725190095088766, 0.3126455483380328], [0.7182993136885033, 0.32154138757513523, 0.2679456471765202], [0.27155214720515874, 0.6996548923332396, 0.566255629409495], [0.43590621701375765, 0.6974989440009733, 0.4554280038205991], [0.7848825900361833, 0.8260321912910701, 0.748756490806382], [0.6882541677948929, 0.9331863155917653, 0.44738513605908176], [0.37386891444248777, 0.29470853083541204, 0.8251253925554675], [0.5519698756051912, 0.48746263625739905, 0.2464776108844373], [0.7553764040028658, 0.2722960016032353, 0.4955929432563704], [0.30964744008229295, 0.8623907228981665, 0.30623855068893296], [0.2603754418601285, 0.07055548609096805, 0.2663794550169636], [0.3699423102612291, 0.4476506795767124, 0.3938439060632916], [0.8112215818018879, 0.6518750077235609, 0.9142017100581384], [0.38269350349764786, 0.4680578518824617, 0.46906696443276236], [0.6581688725750516, 0.31993672896316194, 0.6940727001306337], [0.4895104480171107, 0.7806469989747108, 0.49737053704445755], [0.1969844259840906, 0.6321188735197927, 0.3152618542578846], 
		[0.5731074592776654, 0.07490091827782318, 0.6260357123382532], [0.3948068223113991, 0.46349662765692934, 0.36419663368477856], [0.4105879546138594, 0.8451245474965848, 0.7532070858661555], [0.6244405201184888, 0.25497723302329217, 0.6007933928714713], [0.3459310912364049, 0.372097828539914, 0.1101636994361249], [0.5567806417109125, 0.8565702786388174, 0.3678338021519667], [0.2198525857720481, 0.6626278024438269, 0.4608382227284489], [0.6651603214414215, 0.22030954924098872, 0.5754508418489492], [0.24610808175156426, 0.8000947545392746, 0.5274491328959239], [0.2301623647376004, 0.083414470636491, 0.4978310142349885], [0.8546103603049943, 0.9573210624411483, 0.6280266299105416], [0.7004980079690327, 0.71624219820187, 0.2746242838881559], [0.3918218748573997, 0.38087398144438983, 0.678048951276108], [0.707322680163069, 0.35508915237820493, 0.7292097048674054], [0.30018375005601533, 0.13790933949471862, 0.17301668817336227], [0.349959412361082, 0.46601551803743463, 0.19662310012193365], [0.44046910789898447, 0.4885846318663701, 0.15941498751549113], [0.46670579156880726, 0.1375289680126695, 0.38993446495252215], [0.3777456266669876, 0.18691183465339137, 0.4533823508272829], [0.5263335509710289, 0.19262184131820687, 0.7639932392778839], [0.25876537401644284, 0.745282977777312, 0.6118814902951025], [0.6787056590807327, 0.7262284530859741, 0.484204468277757], [0.2279790300588533, 0.2317289326722996, 0.15321499699492094], [0.5178614145772995, 0.2023480657694087, 0.25585870555962253], [0.7565789107349806, 0.36843068819532965, 0.4747929608910056], [0.36565213193208856, 0.7634163868222557, 0.7993948290343846], [0.21283346479862175, 0.15515220502830607, 0.3848427095169603], [0.6844709534216817, 0.7135989759434547, 0.755741907883546], [0.4616414269642476, 0.22862878131131342, 0.766988567268895], [0.5630091505133085, 0.5361220840979518, 0.3239814240539165], [0.46779328855893093, 0.5292699466915441, 0.8097242615696154], [0.24987063815160382, 0.5810912603339593, 0.15406519908885], [0.4330904712686819, 0.30522639652478467, 0.5328949772837965], [0.5579980815072919, 0.8287664497104774, 0.21196376130198652], [0.3395106487133789, 0.29943998370682945, 0.5780702599578293], [0.8690682104674075, 0.8175156571249882, 0.339933947129978], [0.35716980398363, 0.5096544175082088, 0.5926553738745755], [0.19023736000023253, 0.42480285357425146, 0.7665057443736893], [0.5584264161909814, 0.44211752287272077, 0.1602241973396355], [0.6219277512092608, 0.5004123812316559, 0.8591229790915497], [0.6789016722859738, 0.3434976743938224, 0.3012926696481193], [0.8697501011150252, 0.8356752227535539, 1.0047922237495888], [0.3861308208724067, 0.6681073260599533, 0.14458171112050666], [0.29417918395531195, 0.49919183095033165, 0.30778225924212776], [0.15317568466707843, 0.7123801481337035, 0.25959020095803775], [0.7242664940233604, 0.7193796775267912, 0.5287267251954314], [0.8477852024269292, 0.6740205607438979, 0.8322599512116194], [0.3503602673060617, 0.345740531809536, 0.4739238612620846], [0.433094040636137, 0.15231036132200038, 0.502514960779801], [0.6397800782076131, 0.9184496777906594, 0.6624949972521784], [0.32359249527829936, 0.38584932297656643, 0.5782607247572986], [0.5376222001837989, 0.2843943212310475, 0.24504734798083777], [0.13828741100502098, 0.13330286706241465, 0.1442746349048806], [0.6577287223137541, 0.6738987800947662, 0.8095878736004971], [0.39321530360857826, 0.7985889032283755, 0.7492363822817405], [0.7307529618973102, 0.8065519971601726, 0.4488511071855599], [0.6749108202680624, 0.6950389007997154, 0.6935568638095467], [0.47041850496798104, 0.7832012360274732, 0.39136004857564627], [0.35801384269849795, 0.07458315981211287, 0.5460526060425563], [0.4357119464340887, 0.13999402258022495, 0.18372801720780096], [0.6995664389214824, 0.39508143657090955, 0.8938408826718038], [0.11324202406287248, 0.39393459868717584, 0.4180118848792189], [0.5598489664057115, 0.29610595433291625, 0.3025498272319988], [0.7480823247944525, 0.8649212788389093, 0.7203263342364327], [0.3833726681728807, 0.4165441845084523, 0.749908981361797], [0.782689236075212, 0.7718794601948766, 0.6428583511798706], [0.36728257871468767, 0.5461382159661967, 0.1020042237638195], [0.744990678443081, 0.43851099113943615, 0.2487546012662155], [0.866401057131005, 0.8764767037533766, 0.5144149737436716], [0.5500364697869875, 0.3712660882160241, 0.4969123405654504], [0.3442843682671718, 0.5698343279606196, 0.59027878994042], [0.29179004832550803, 0.1972811170026848, 0.8712174247566413], [0.29938003844564565, 0.8651908821807245, 0.8396096890018634], [0.2973550154420476, 0.15146665605929194, 0.6414271666483901], [0.2174306239342839, 0.8185343616631181, 0.5500833906397916], [1.0646869128357204, 0.8134329406124057, 0.6115934874996201], [0.3520279475973265, 0.8338446432108442, 0.7028817326918865], [0.7952736217766878, 0.9196527605790096, 0.19963618964660362], [0.7123447250945193, 0.3530650133421584, 0.273783937068685], [0.7296092949793405, 0.15711791222754515, 0.8376960738092103], [0.6895551083248839, 0.37115020129911297, 0.5808705604377047], [0.48934726809150286, 0.690195619125543, 0.8134796259365992], [0.17163557073346794, 0.3641703330022219, 0.9340134530768364], [0.07488829088250468, 0.9420458201194464, 0.6338595761368189], [0.5309478090600542, 0.6237576235562993, 0.5894619411192719], [0.8182143745431826, 0.4122800543045916, 0.40187029932228885], [0.8844522978545754, 0.9349366858029057, 0.177409820474875], [0.35118233191583564, 0.38069288111569727, 0.0193845858108066], [0.2833324673371539, 0.6714952192322577, 0.6399830892252111], [0.813348207020816, 0.2965580761400446, 0.7608212076006238], [0.10761116344074263, 0.05230180351034901, 0.3913972996092498], [0.11031176616019274, 0.5584434431809002, 0.1390832161138058], [0.7537647600238673, 0.7020480414885684, 0.72547132919797], [0.834230129847912, 0.5984652691647473, 0.844974188164606], [0.10026163235444208, 0.6595460039162928, 0.1191357651724538], [0.2600148590463917, 0.8229168206579718, 0.7465725078071331], [0.3846455690116899, 0.8545880876109953, 0.17474874684500835], [0.429066841576162, 0.13313633936900227, 0.06194597087104597], [0.4084819261165353, 0.21190669982066782, 0.2485164728036232], [0.7652902046722563, 0.43394320029511285, 0.7524140106592848], [0.3592465477801071, 0.29378527800909615, 0.6094961501027906], [0.820082663940586, 0.9624138117427602, 0.9297551605763181], [0.7397614873236787, 0.14423075347476233, 0.6474703089429537], [0.3430858179087964, 0.4858029717505093, 0.6939528570738575], [0.9202080184682049, 0.034021520550667074, 0.3362598684608331], [0.31190153415889094, 0.31045468263601567, 0.22700351356042703], [0.17247036077869154, 0.24890600903058377, 0.1323231302534949], [0.6919980473567307, 0.45799266339320166, 0.9338163064199033], [0.5301193327168144, 0.4152302573221278, 0.21867823525725427], [0.3789278947477755, 0.23865026418676594, 0.7555234318956447], [0.2578932774570039, 0.04450800969597626, 0.452348165973397], [0.11220883293854676, 0.7595657401407997, 0.6552334159445818], [0.8584662196480115, 0.7371594512650235, 0.6492718852743766], [0.668131928279532, 0.12881531568296775, 0.32931256023016553], [0.5544469534077001, 0.15112963953291828, 0.14186764814085537], [0.2325919239543062, 0.3185713441628208, 0.14544003296526994], [0.7238222119068514, 0.6305302796635074, 0.6873346761747728], [0.9936725202687241, 0.9444967749138693, 0.6882062096288253], [0.7417531993731339, 0.1524394658832238, 0.24128182576463275], [0.2407440200814245, 0.5086110272528087, 0.6545404911826639], [0.8783803286305648, 0.8204472652473321, 0.19860342981795562], [0.8789988775587698, 0.6258816028036579, 0.9340917973624733], [0.632984113856629, 0.5216169256382555, 0.15851390326936782], [0.23047949142527543, 0.4950215214147343, 0.5362842824142049], [0.5944144416191784, 0.67724955562443, 0.8717773977883191], [0.13923562769981457, 0.7586477793792533, 0.23175931956763887], [0.19849871940745603, 0.07295357328851573, 0.4882371929575769], [0.7340562544049007, 0.43339675784479453, 0.9226871211814123], [0.0972955224381574, 0.26835992500494166, 0.17342298387565178], [0.37909767594717575, 0.4574036517798833, 0.12169367800364879], [0.4196051922483911, 0.48055822147077093, 0.8748405712135199], [0.15544609625472822, 0.7937402734415047, 0.02767633224752398], [0.1633888477546447, 0.4872289778938234, 0.9279119678818829], [0.807093721350563, 0.6449608134327345, 0.20844165942736684], [0.13493636883534624, 0.7466090013947265, 0.45369844466584064], [0.10315930895373616, 0.5562262372755804, 0.998754951714406], [0.6773536610321145, 0.2358226104298532, 0.5911160778069731], [0.6623165640266744, 0.15002152234270433, 0.5373737579460631], [0.8726044332866181, 0.511910089213877, 0.40008184522675266], [0.9178094970957769, 0.9709665867585501, 0.20184198665968206], [0.11336898126856935, 0.5375689285674803, 0.6518521748678177], [0.43685479925019793, 0.895771314548818, 0.4254310784474036], [0.25477756460551154, 0.20043575366282873, 0.2949518408671322], [0.6712370440706475, 0.10746086261737485, 0.3518869041619429], [0.799933400822633, 0.3718924770849647, 0.26918717996339997], [0.3817663513446855, 0.5282590668647237, 0.42042952484732626], [0.5606635424331208, 0.8427704607979611, 0.9533411077663898], [0.15965173139481975, 0.31865745886500857, 0.6239718923938012], [0.6550240397268142, 0.549869122223769, 0.5971689093900862], [0.988533395906469, 0.3357036929164095, 0.7866089289975471], [0.4809288689410936, 0.8356841145842678, 0.15766292363087434], [0.1634764463097612, 0.1698473859391369, 0.1684322149989707], [0.33456314875379417, 0.6886700732964014, 0.49705030442448167], [0.3413773010511229, 0.32640308598745305, 0.13506330905261757], [0.6565155358465263, 0.9686376901605521, 0.9383058903529801], [0.8696564009081932, 0.6561618297405649, 0.2111192570922865], [0.0940686494345756, 0.21806986617953436, 0.6909683377255446], [0.4652941891107607, 0.45234012865765466, 0.23404838242058779], [0.012947109382759697, 0.5909616281469605, 0.03017438565570552], 
		[0.12493547515085816, 0.1724474994136922, 0.7103748716754513], [0.22791215246233532, 0.12750574905227027, 0.1956415134918212], [0.7788662796245042, 0.63113500576495, 0.06899551898599904], [0.21343661739462666, 0.4085077313998996, 0.17817198068979254], [0.37461758470769163, 0.869621995595736, 0.2177913721007053], [0.3467588747133694, 0.838169842553807, 1.0033043452976196], [0.23683905109860964, 0.3160465536202581, 0.36026887211922576], [0.2697136384479155, 0.8278928588997567, 0.5554005048788283], [0.5691892194036453, 0.7051413591379161, 0.3336202056079753], [0.8876661216503567, 0.38654641850735927, 0.9993531482036812], [0.33202613813170817, 0.33801688389428686, 0.8926465765187356], [0.7630964506918326, 0.680937037755906, 0.8148567309876255], [0.8951601296966734, 0.5532897980689557, 0.7832875509344568], [0.42614797798436405, 0.8270900303924349, 0.33204639389476864], [0.9201164215355051, 0.27708391846914976, 0.7135193313871745], [0.21415846873088565, 0.6327690815330165, 0.123984453696403], [0.2421539406705157, 0.3029154010998007, 0.26809977332360657], [0.6937066273514207, 0.18435104054949922, 0.4943627061680735], [0.2585074744275219, -0.03625530562744892, 0.321168780551348], [0.8387990279575065, 0.8950655533432682, 0.13251620525775715], [0.9764515086823706, 0.04218290155813062, 0.9822313592114984], [0.9406021749438589, 0.571009406503554, 0.23031656404137776], [0.42096339296701185, 0.8233442093200525, 0.05296751513082494], [0.2294500290361969, 0.5981938609604772, 0.8014983457126261], [0.8875184850669497, 0.5620226595846068, 0.32545861420149375], [0.35673487256160713, 0.7029155367346921, 0.6486118178198176], [0.512731591084355, 0.3961462231281877, 0.26418383944995777], [0.8908871188798659, 0.6865806755888081, 0.4048997579611652], [0.34057204148878034, 0.9562334107977497, 0.7939618630953438], [0.518312995098682, 0.1106938896488615, 0.2478562562663178], [0.6547177320929798, 0.6134489194173443, 0.06722500929071151], [0.32432077563116224, 0.6362968943254437, 0.6890299679993597], [0.8384902514595491, 0.781643445851142, 0.44959263657658505], [0.4376411633684343, 0.5199196262067124, 0.8444395598303972], [0.27073033158983195, 0.8995105706960669, 0.34023205864349626], [0.2954765835440637, 0.32747800492643125, 0.9292863436038152], [0.7303448735426519, 0.4767991295959524, 0.3922274457042155], [0.9259565348982404, 0.9596855785099666, 0.9104114624040683], [0.7897992785578384, 0.4113013023151686, 0.9357852223825057], [0.3360834430799709, 0.41289580463369063, 0.8322767489165523], [0.8519378586513805, 0.3476343102578886, 0.7853574807461537], [0.5861060541880784, 0.67414405386185, 0.0504004316387131], [0.7929851219957943, 0.25312242082379516, 0.34576531502677926], [0.3636155093888536, 0.4512279030207569, 0.7917562615252236], [0.3298725478838927, 0.4955812522970506, 0.8985713491647124], [0.2646566680997793, 0.8076437159766637, 0.47028816499122117], [0.6222794025534177, 0.8823730505353753, 0.7980959464993628], [0.463911021294025, 0.26897676283818533, 0.5117521178112423], [0.2473429910784791, 0.2118153785932436, 0.629396304312367], [0.9718678385380589, 0.13643551651177402, 0.2389746882477293], [0.12449870961107817, 0.3259865242001315, 0.7386535292234337], [0.8763016549799815, 0.5892079633799423, 0.8860131726882682], [0.06729183321177251, 0.10169478898741131, 0.38038304420725844], [0.13577441493809275, 0.13028225166966695, 0.4053660949578949], [0.21931694906612023, 1.0075695928738932, 0.22683198812802977], [0.5279478553657985, 0.17396885725686362, 0.2138877733355218], [0.8653210651212485, 0.7623468059060083, 0.8490168308984612], [0.372068500635601, 0.10757223476800937, 0.3940041364129632], [0.35427247424122205, 0.4117835563570564, 0.16332541673825096], [0.524547552987459, 0.9518353450107124, 0.16006040394139368], [0.15543720123095786, 0.20121708932267154, 0.4366592121578107], [0.45871031518485694, 0.6153743878121376, 0.5643447493236716], [0.4950170098218967, 0.44142560944036296, 0.41683241792984443], [0.5188750508738081, 0.11133809656196261, 0.24036598127737688], [0.5635539411737516, 0.3919738860090896, 0.03752408206344606], [0.3887352407408221, 0.13604655204080357, 0.07761732187031785], [0.4015311883932635, 0.2716318417688443, 0.7773557377155912], [0.2517375719583257, 0.7173124830579092, 0.39027767862744833], [0.7331872029204514, 1.0114936214358388, 0.39486909117063124], [0.43789024577756297, 0.4186628259127098, 0.18739289234794684], [0.38292484195801635, 0.1534645801945248, 0.2481783982493756], [-0.07302427928540273, 0.2694894758010644, 0.35614499889455004], [0.8593511186320266, 0.6354774291668771, 0.8771073451425483], [0.4528874231369661, 0.6960625837562796, 0.3791098795180433], [0.1656797029192636, 0.1334837825112524, 0.2953844073009896], [0.5914637733217368, 0.2860645722707099, 0.8675819299803611], [0.8039088852267012, 0.46963493192415784, 0.4257648682141266], [0.6711426928427331, 0.12429334501210283, 0.5594905648788073], [0.0866430391725103, 0.6247856472569948, 0.1992194149950013], [0.7799664860093241, 0.23076312080027886, 0.8279795830344394], [0.346176794860647, 0.30258823528346435, 0.6223332143017493], [0.21826045094703442, 0.9695332609891936, 0.4724308988994495], [0.7859341641025095, 0.42856968366860154, 0.6957295008631315], [0.8958042894568999, 0.46194995018334706, 0.923639223517771], [0.7225717382944272, 0.7545400049416281, 0.6598858470008856], [0.7113353352970062, 0.18688215186002857, 0.8934134050736707], [0.4898523574244565, 0.26901415449952526, 0.7586801510063321], [0.7636660154764837, 0.2676134144232814, 0.6224833242607176], [0.1452701251328041, 0.625085705979074, 0.7064284085831005], [0.6491787328909869, 0.6747782461994298, 0.4726042901641508], [0.7851449315179003, 0.7432845218872365, 0.831094746000009], [0.053539250376303325, 0.15809065453498614, -0.04492739799133603], [0.04809860851209203, 0.09092608194014702, 0.3117744879007646], [0.30231291038679126, 0.5469575633283704, 0.284118264078561], [0.41677031381157825, 0.942426064740987, 0.4073839747706182], [0.2183058937252418, 0.44295453806554286, 0.214642786160839], [0.6243731464590804, 0.6476927698424161, 0.2561269765508141], [0.25989100880884886, 0.7342005896841123, 0.8387530851144741], [0.1559859893312313, 0.4620953673398171, 0.30601908993780386], [0.3771874670344273, 0.19424119756981198, 0.5604702660111875], [0.5876829081908462, 0.211993134217139, 0.1397670938268948], [0.7444107191967124, 0.7152772130678552, 0.3694485751577536], [0.6019660183766544, 0.36247617314115116, 0.3841210876039834], [0.2563487914306315, 0.9326188114009047, 0.10949688204928429], [0.26479444476975356, -0.0024734935750710786, 0.21064144898958], [0.1816424437586011, 0.2805245938727126, 0.6840870695227014], [0.5729435965636164, 0.3839698825982906, 0.9619511996217079], [0.7608486586106478, 0.742698902085533, 0.8742194075168381], [0.49156559944945094, 0.4424454522537246, 0.07827914328699924], [0.12031552065005391, 0.09980635303783113, 0.3198423671300669], [0.2514540983897629, 0.5561574645644735, 0.6341047036273002], [0.8039360603023968, 0.5250766390020447, 0.14683887013921124], [0.15346379097085575, -0.0063311764021887, 0.3934519524076566], [0.699743880698107, 0.924113543393476, 0.3476390886091555], [0.641688250316443, 0.4842367856877464, 0.5350831535975078], [0.5696757047216745, 0.6232867919017083, 0.1375814224164628], [-0.012410060752875006, 0.7438617604757819, 0.47945071019259994], [0.8063924819898776, 0.2593156175958093, 0.5255635121519342], [0.009196059066045703, 0.6556947943500001, 0.531655225496746], [0.19237567969227312, 0.25436370443257333, 0.32963247294627096], [0.8399337085112112, 0.7528469309895464, 0.22473204301217198], [0.7778368295716913, 0.29656044212432237, 0.17992856931616694], [0.2164359221675146, 0.6944206663563848, 0.5805014116953146], [0.8498473534682371, 0.946110949171284, 0.7818049029405943], [0.7761149440460425, 0.6375360708124027, 0.8673005461369133], [0.585382721074341, 0.5533055052776443, 0.471955715347072], [0.7684819382593059, 0.2178947125342167, 0.17167785152742732], [0.30983847278087046, 0.5707225798139564, 0.20098177317198934], [-0.04229292780465314, 0.018998738371266744, 0.2682672025774443], [0.7582056533442894, 0.09645116611247656, 0.6251331494452962], [0.6681119729882672, 0.9169649620865348, 0.5513864108507855], [0.10666672360814218, 0.7214497688091843, 0.7142263413820805], [0.412769383268515, 0.8268911020971921, 0.5428647226392657], [0.38525352133514834, -0.007814820743319312, 0.7370899591047603], [0.32977779779875777, 0.8677667909896605, 0.05577723290976113], [0.4021549892299322, 0.3646070462873421, 0.8156936923773281], [0.8772484363804318, 0.3660570096575919, 0.8334478951269121], [0.3508739886011681, 0.1867461557844774, 0.48995968591090355], [0.625237262096216, 0.3185012733330404, 0.7040379381379871], [0.08822999357898265, 0.7413375925415503, -0.014093612751204215], [0.29085672927927764, 0.76800735002446, 0.8807106377809042], [0.6624023888629254, 0.29610883220213524, 0.3779998846945644], [0.8272829466037767, 0.17009229490133726, -0.02233644172098911], [0.15603565489942692, 0.33091796756586517, 0.1523269813011323], [0.8276213531725474, 1.0813401395154731, 0.8727479803094811], [0.17397949657840203, 0.47871052871305786, 0.7932897730081392], [0.634253637102712, 0.3995004493530728, 0.4893589808649188], [0.8090842159118496, 0.3305106294518611, 0.097516613393132], [0.5116934692458862, 0.844269802137017, 0.9270158174082368], [0.4916285293261082, 0.8781091607524488, 0.489701904088903], [0.33249578069400204, 0.9260396220326663, 0.4723111881797261], [0.5695231965524071, 0.837462346123132, 0.753131591617171], [0.6074399748545126, 0.4725465056621774, 0.3872710579189875], [0.35778284884528366, 0.17766305735346793, 0.029288721066955237], [0.12552383842418316, 0.7241452798943881, 0.11644198640769443], [0.6077320903034668, 0.6330254545911571, 0.6329016133991775], [0.12418757698156438, 0.4286936233395093, 0.724315674552505], [0.07522554032512263, 0.35000811796411563, 0.38226788629960007], [0.16278081942236, 0.3331921418285281, 0.6769339916914565], 
		[0.8066019268802715, 0.24118703300882768, 0.8461527308057175], [0.3111502635389765, 0.21781279218381197, 0.7386764497711106], [0.9206853007484349, 0.48828490651727163, 0.3305409799078079], [0.4434630696361027, 0.8423590018603608, 0.6553242331585671], [0.4065809177204922, 0.12855721045602594, 0.29170128507588433], [0.7794703354106254, 0.8820384103845256, 0.12376174986280067], [0.8615451997220084, 0.022548893254624298, 0.8568788183983181], [0.2556345686668822, 0.49060194841984595, 0.6310413995125903], [0.25123229077016007, 0.3552386111338045, 0.22320219761254398], [0.2380264430723328, 0.24138337163695847, 0.3796717610604204], [0.7576641981822977, 0.1706582581181209, 0.47875332583144814], [0.5350882592253149, 0.21564783796296189, 0.5695367240907817], [0.5624344684489206, 0.36945150196207555, 0.007337043012184249], [0.025542278866495058, 0.1516797944870838, -0.00997481731897384], [0.37954321202393315, 0.8801076414475519, 0.07807883713083807], [0.43880603998995515, 0.3404481267143109, 0.2497066181365403], [0.7041498774999869, 0.8087588799053133, 0.5604850665198292], [0.22351069161329723, 0.8304127738219705, 0.6692222879594644], [0.41938580314156215, 0.18288321899442572, 0.49226093737098], [0.18326894257348855, 0.7449852496028095, 0.8077717286875177], [0.4724340278071338, 0.02842994119335273, 0.3766877858113477], [0.9017886166461428, 0.8842814515639906, 0.1916953156291736], [0.520897542810463, 0.4742566407610131, 0.9308500936979902], [0.6305715178629829, 0.7787426125457042, 0.2863759353700489], [0.9184073723690751, 0.6220558477314724, 0.9368784202282193], [0.9514221046076357, 0.4777698950588868, 0.6433712539943321], [0.04020752984076298, 0.41825479555225703, 0.49218449386919216], [0.6334532537023423, 0.12301636264161488, 0.5768474513957635], [0.5256995310564846, 1.0035631334545931, 0.04972519094880889], [0.7149423995334944, 0.22603015598039278, 0.905723919955258], [0.7011697577429176, 0.7498522168440905, 0.5621225386604445], [0.5412688937339643, 0.36248947929007963, 0.6171771261078292], [0.48148781153817927, 0.6046390189287271, 0.12434810465751686], [0.2295619149852867, 0.2318479877346223, 0.2614699646320482], [0.42303983329519795, 0.2882847098568053, 0.3180452239946154], [0.5660547380862213, 0.2704827362643418, 0.9019522481905116], [0.3578898314915005, 0.8193205894965131, 0.9037024166455021], [0.4688905324543095, 0.4111205421517732, 0.2768073662229557], [0.8306223177769684, 0.7521926009242672, 0.4533933242893016], [0.3594728570586658, 0.8398117410701625, 0.04621965491696609], [0.23380571476116316, 0.5495786279842272, 0.8158807925394744], [0.6768090892002536, 0.5882187668446329, 0.48611873671918193], [0.8799219587262959, 0.20946951735857983, 0.8182549417414552], [0.0959940366546952, 0.6124670332469128, 0.23472762335608838], [0.7302890688394218, 0.3688090863381847, 0.5725086337003492], [0.3800837540320867, 0.9040113062185156, 0.4290745819792269], [0.860807110252373, 0.868741168248721, 0.7665468894402288], [-0.010323178033474299, 0.07168246665774351, 0.562032299552632], [0.40200072126503994, 0.702124274366084, 0.24528680132768513], [0.467061116918861, 0.8320747946028196, 0.35567560277026633], [0.3636571318204514, 0.6145506040815157, 0.2796286284280543], [1.0639370111031266, 0.8292848018559829, 0.935254560235591], [0.25574559763093224, 0.6720284403925753, 0.01952252749280167], [0.30976032099188294, 0.6620625122812374, 0.7955911833527599], [0.7171234019603142, 0.6655381719199391, 0.47254206992008924], [0.24205504945271258, 0.7429518829098951, 0.6220272463752138], [0.4420492259277148, 0.44724675513529016, 0.7391205841234135], [0.317807301609826, 0.46552885897363644, 0.36352326106896127], [0.20549850077571163, 0.2645246221432479, 0.5505045136720657], [0.4671102290162129, 0.2965001264692114, 0.7452885134175347], [-0.011138162761741247, 0.19121806703137814, 0.11941026352474936], [0.8135838380395042, 0.5176962528898147, 0.3319124018777935], [0.456524586882385, 0.6961035931312965, 0.20139681392857128], [0.3626951469102514, 0.21384800312369617, 0.2543021519435045], [0.6526427120501219, 0.7615535127853694, 0.42949634329849745], [0.8200190247291611, 0.9246273405898047, 0.876222278956757], [0.3704915682667771, 0.008201801939465759, 0.8535886949388158], [0.1450794969747192, 0.8046040681702319, 0.09741006346608659], [0.7789051175404141, 0.09452737982219563, 0.8050162687171487], [0.6920842836704489, 0.7174549222050538, 0.8240208416350782], [0.25258006330358546, 0.9678889980647337, 0.6229237870371149], [0.2989452870292775, 0.6022495449301307, 0.08516114426607917], [0.3839990554190931, 0.22237466459424512, 0.2013696080590425], [0.8291170237039606, 0.29671366496886803, 0.5964719704957445], [0.6396291160847203, 0.4579470930925097, 0.23225133752816826], [0.7739101988666155, 0.13298489618844736, 0.13327186589551046], [0.2866742687907077, 0.8549483097599596, 0.6448992924055934], [0.2357479271106485, 0.3468735343632993, 0.7849480388607278], [0.7997579470379722, 0.665502352973565, 0.36279656006024374], [0.13076580480017305, 0.5672179650938067, 0.556316827676451], [0.6186352310537344, 0.1826648387234797, 0.07560164321933802], [0.9160229677786353, 0.16796009878660217, 0.8423462396194091], [0.8828009256847329, 0.19811603469062147, 0.18926459564018555], [0.20652337782272934, 0.2218793887075371, 0.08449911530180726], [0.2922944540550583, 0.3730527570108466, 0.7470326558839121], [0.3470510751881415, 0.12796295645145433, 0.1990721398197901], [0.8363732558750488, 0.5627848335250897, 0.44081677877808817], [0.12289024168447532, 0.9716510608889732, 0.5032375573928498], [0.36255232733927856, 0.5306904799960324, 0.3762296043770868], [0.1271090510974419, 0.47250812997251923, 0.9094382557636718], [0.7175515932894694, 0.6447019555793652, 0.06726833334533243], [0.7749409385807581, 0.2940927720513804, 0.2766767830937621], [0.506350330638967, 0.2735106059447698, 0.047208526383322666], [0.0480438271554717, 0.8910703472794238, 0.43226325254231035], [0.5609206370884677, 0.5191013258856085, 0.32343420140564244], [0.035540735556599236, 0.9353076458713339, 0.7307019859199014], [0.5647242993322966, 0.32144590920598815, 0.9842935226649763], [0.2425273980854651, 0.6158355578050159, 0.8975993039138944], [0.940822322600269, 0.9033192946111083, 0.779949263401843], [0.8782055056095686, 0.1734150575141711, 0.5002495090691029], [0.2614590560932692, 0.4467013114179955, 0.2607938696843039], [0.9267276717593063, 0.7125017115886929, 0.506162228678897], [0.21993462634548047, 0.10755276372384755, 0.6996528960392495], [0.6605829214844523, 0.7109587025143005, 0.7821219629172296], [0.34539255208402436, 0.11032688225445487, 0.25676932699612237], [0.2151375579868438, 0.22559118025811212, 0.880940911864992], [0.6316411350461192, 0.4452872528724905, 0.4029205524356898], [0.2501611003358704, 0.666005262562419, 0.9735045588242469], [0.7216470479508036, 0.229494956111972, 0.756677924533225], [0.7267150574719938, 0.5080901837043504, 0.4911335302152611], [0.6196247406964808, 0.7441992075027746, 0.397707321060481], [0.13409784696524718, 0.177787356338621, 0.0298883137569432], [0.4308203515404219, 0.6759443151033737, 0.1601259135183923], [0.1835620427399107, 0.9442398257308395, 0.19249768959464392], [0.8363808063222877, 0.2612372946520381, 0.32129550172385496], [0.11815239743126606, 0.5440241657241699, 0.5814876390704977], [0.2313866291748674, 0.4692374974474301, 0.7585906984787072], [0.8256105260216792, 0.8967263540015961, 0.7203823692385563], [1.024408810892863, 0.8210470373771442, 0.8411606822513262], [0.32645980856229434, 0.34794621613432714, 0.4286029155936194], [0.5889530089739323, 0.9188726070282769, 0.4370688316895649], [0.6492887272365602, 0.4937379239530226, 0.16758612989438137], [0.4479235060772004, 0.9356190341940469, 0.8881016894963255], [0.753400191538117, 0.09522298900266968, 0.49784116086793795], [0.7546370956343637, 0.5578403311662166, 0.42217343425069215], [0.5277456029995735, 0.14987771805865935, 0.364174200125973], [0.22527738711527287, 0.4035868746461321, 0.0572440505118203], [0.7492296801530225, 0.38821702879838194, 0.4330281854295246], [0.05629039770789393, 0.27406347023648453, 0.48000019793232307], [0.46414346740175033, 0.617675589062478, 0.6359006764736209], [0.12156686337832331, 0.6498958460604326, 0.7807005956338786], [0.9905517739341615, 0.048127404829369426, 0.36693538593675185], [0.7873882728962638, 0.8390157626307324, 0.39057378578608076], [0.10423574640456158, 0.09153581095003241, 0.27387877299361185], [0.3266276905235366, 0.3694973318344848, 0.03229867950010826], [0.5164049875589571, 0.8533422420510636, 0.4308086658042046], [0.6850453408396292, 0.25798768394604216, 0.8670687850433777], [0.2212000321320217, 0.8492962713933176, 0.6476542979715164], [0.035587255205262805, 0.7761307357701849, 0.37947781947833586], [0.6177756033563527, 0.08459851459307573, 0.5353801708575984], [0.1591289476501497, 0.6796770542369066, 0.5053883034913745], [0.31023914664362906, 0.9207556614681338, 0.3967972208876067], [0.06376988017195415, 0.15919523758283036, 0.8440829900488951], [0.3835715224929334, 0.08600072993152123, 0.07675839127766337], [0.6906664647756071, 0.520193156503228, 0.42188753713446764], [0.0922060069483485, 0.2644074153146752, 0.8694593019932441], [0.2560790400712834, -0.0019703506222698095, 0.4053247072569916], [0.39143468376192775, 0.2918901305644177, 0.2293433774879092], [0.7764498622300449, 0.7087764304298407, 0.5037742603812253], [0.5713224705382574, 0.43345693715322275, 0.6101241286903866], [0.4573244954329132, 0.6580593190186728, 0.7870508036858314], [0.8840628954219515, 0.4125079873344718, 0.6834566141495223], [0.875113224049919, 0.18138569940461016, 0.4466754757047191], [0.4598785685831112, 0.15685799106870008, 0.39876434517419257], [0.37587317150979965, 0.19293725294843175, 0.39154170296473445], [0.3007017469928919, 0.5446665946732114, 0.7722484335687868], [0.6715877650193853, 0.6892119989083457, 0.8809046468773922], [0.8436642420007489, 0.9823433094467089, 0.7032143536237708], [0.6532340976156354, 0.7293386989057645, 0.29154777227295164], 
		[0.8445733874255101, 0.3530175177426771, 0.24410353710305877], [0.7779428912922959, 0.38210159720877085, 0.4373485044811248], [0.5011729647382422, 0.8647132809309552, 0.6992516462956202], [0.2567190402417496, 0.0561597734202676, 0.08062800136193235], [0.08836148110983809, 0.5499697810818455, 0.1818754281379501], [0.27991804811760795, 0.5806747808589198, 0.644990073328171], [0.8840309403616778, 0.4962374526987757, 0.9781701740793977], [0.4215813473104121, 0.455275510116911, 0.3421045751175418], [0.30390112627903104, 0.6600736174506833, 0.5218012026835896], [0.12944314023406803, 0.14523824099079036, 0.4479514906392565], [0.7648854835449395, 0.56736278978942, 0.47912443726166964], [0.5042771267014926, 0.2723947792136757, 0.07045063386339762], [0.14059538866002183, 0.43641016399564575, 0.06304903092146238], [0.023851320417605192, 0.1585070457556574, 0.8891881983722083], [0.13119444141479453, 0.9546682794244098, 0.5101227181402481], [0.44521278324542196, 0.9797269078454002, 0.3814462410847783], [0.858360032491417, 0.21481758406389512, 0.2935273447582345], [0.20575368004710515, 0.8707632790189975, 0.6197911242467061], [0.3726084207560238, 0.8507568457639132, 0.31144322467150787], [0.5131138040980943, 0.7577075160472985, 0.2459429233489965], [0.19119102760700823, 0.8446327942375844, 0.2037246648826651], [0.5267975805826327, 0.038146490194276746, 0.24879474056339246], [0.3772759186812265, 0.061284750061477426, 0.5245349311143885], [0.5652870218297131, 0.5306190877700411, 0.15864941055406323], [0.639651745225592, 0.678798637387863, 0.8141294905539882], [0.31440150235862035, 0.20309605921774995, 0.14815358457257952], [0.5325945029903597, 0.8993971373504913, 1.0259149549030158], [0.8242234034744514, 0.4952350872178995, 0.5748450021814724], [0.7114958268301433, 0.19889139194796446, 0.24749157099323843], [0.37837845110566426, 0.24284219555898656, 0.14739668231823888], [0.4738290428252863, 0.4183814575105524, 0.2548483991840092], [-0.02468942435161738, 0.32056507489699343, 0.3632156919713479], [0.6848988288645504, 0.40335448896415665, 0.6023303492767378], [0.18117007430827373, 0.6338587285128827, 0.34337964170079344], [0.9369593129845926, 0.17996358920684355, 0.5907096946495142], [0.5712308126001452, 0.4488213117347118, 0.7840856487702149], [0.44262649915673064, 0.6702368059573466, 0.6186710504794637], [0.5768476342201819, 0.6549064111652207, 0.7213787787326673], [0.02023192032288872, 0.5183911401274355, 0.18140364959249808]])
		model.bias = np.array([[ 4.7898296 ,-1.65312153,-0.99907865]])
		mask_img = model.test(img)
		selem = disk(5)
		open_selem = disk(1)
		mask_img = opening(mask_img,selem=open_selem)
		mask_img = closing(mask_img,selem=selem)
		#show mask
		plt.imshow(mask_img)
		plt.show()
		return np.uint8(mask_img)

	def get_bounding_box(self, img):
		'''
			Find the bounding box of the blue barrel
			call other functions in this class if needed
			
			Inputs:
				img - original image
			Outputs:
				boxes - a list of lists of bounding boxes. Each nested list is a bounding box in the form of [x1, y1, x2, y2] 
				where (x1, y1) and (x2, y2) are the top left and bottom right coordinate respectively. The order of bounding boxes in the list
				is from left to right in the image.
				
			Our solution uses xy-coordinate instead of rc-coordinate. More information: http://scikit-image.org/docs/dev/user_guide/numpy_images.html#coordinate-conventions
		'''

		boxes = []
		binary_img = self.segment_image(img)
		#clean up image
		#find connected components
		contours, hierarchy = cv2.findContours(binary_img, cv2.RETR_EXTERNAL,cv2.CHAIN_APPROX_SIMPLE)		
        #iterate through all the top-level contours,
		#draw each connected component with its own random color
		for idx in range(len(contours)):
			color = 255*np.random.random([3])
			cv2.drawContours(binary_img, contours, idx, color, -1 )
		
		#go through each region
		#find apply shape statistic to include or exclude as barrel
		props = regionprops(binary_img)
		for reg in props:
			#make sure area seen is sizable enough
			if reg.area > 1000:
				major = reg.major_axis_length
				minor = reg.minor_axis_length + 0.001
				#make sure area is shaped like barrel (longer than wider)
				if major/minor < 2.4 and major/minor > 1.7:
					#minr, minc, maxr, maxc = reg.bbox
					#boxes.append([minc,maxr,maxc,minr])
					y1, x1, y2, x2 = reg.bbox
					boxes.append([x1,y1,x2,y2])
		fig,ax = plt.subplots()
		img2 = cv2.cvtColor(img,cv2.COLOR_BGR2RGB)
		# Display the image
		#ax.imshow(img2)
		# Create a bounding box
		'''
		for i in range(len(boxes)):
			rect = patches.Rectangle((boxes[i][1], boxes[i][3]), boxes[i][2] - boxes[i][0], boxes[i][1] - boxes[i][3],linewidth=1,edgecolor='r',facecolor='none')
			ax.add_patch(rect)
		plt.show()
		'''

		return boxes


if __name__ == '__main__':
	folder = "trainset"
	my_detector = BarrelDetector()
	for filename in os.listdir(folder):
		# read one test image
		img = cv2.imread(os.path.join(folder,filename))
		#cv2.imshow('image', img)
		#cv2.waitKey(0)
		#cv2.destroyAllWindows()

		#Display results:
		#(1) Segmented images
		#mask_img = my_detector.segment_image(img)
		#(2) Barrel bounding box		
		boxes = my_detector.get_bounding_box(img)
		#The autograder checks your answers to the functions segment_image() and get_bounding_box()
		#Make sure your code runs as expected on the testset before submitting to Gradescope
		
